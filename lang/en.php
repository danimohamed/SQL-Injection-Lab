<?php
// ============================================================
// lang/en.php - English Translations
// ============================================================

return [
    // ---- Language Switcher ----
    'lang_switch'        => 'FranÃ§ais',
    'lang_code'          => 'en',

    // ---- Common ----
    'back_to_menu'       => '&larr; Back to Menu',
    'vulnerable'         => 'Vulnerable',
    'secure'             => 'Secure',
    'executed_sql'       => 'Executed SQL:',
    'sql_error'          => 'SQL Error:',
    'error'              => 'Error:',
    'username'           => 'Username',
    'password'           => 'Password',
    'reset_database'     => 'Reset Database',
    'id'                 => 'ID',
    'role'               => 'Role',
    'rows_returned'      => 'row(s) returned',
    'no_results'         => 'No results found.',

    // ---- Index Page ----
    'site_title'         => 'SQL Injection Lab - Educational',
    'main_title'         => 'SQL Injection Lab',
    'course_banner'      => 'This lab was created for the module <strong>Application Security</strong> &mdash; EMSI',
    'card1_title'        => '1. Login Bypass',
    'card1_desc'         => 'Authentication bypass via string concatenation. The attacker can log in without knowing the password.',
    'card2_title'        => '2. Data Extraction',
    'card2_desc'         => 'Dump all rows with OR 1=1, and extract specific columns with UNION SELECT.',
    'card3_title'        => '3. Privilege Escalation',
    'card3_desc'         => 'Modify a user\'s role from "user" to "admin" through an UPDATE injection.',
    'card4_title'        => '4. Delete Injection',
    'card4_desc'         => 'Delete arbitrary rows or wipe the entire table through a DELETE injection.',
    'card5_title'        => '5. Blind SQL Injection',
    'card5_desc'         => 'Extract data one character at a time using true/false responses and SUBSTRING().',
    'card6_title'        => '6. Secure Login',
    'card6_desc'         => 'Same login form re-implemented with PDO prepared statements. All injection attempts fail.',
    'open_lab'           => 'Open Lab',
    'footer_dev'         => 'Developed by',

    // ---- Login Vulnerable ----
    'vuln_login_title'   => 'Vulnerable Login',
    'vuln_login_page'    => 'Vulnerable Login - SQL Injection Lab',
    'vuln_login_howto'   => '<strong>How this works:</strong><br>
        The SQL query uses <strong>string concatenation</strong> to embed user input directly.<br><br>
        <strong>Try this payload in the username field:</strong><br>
        <code>admin\' -- </code> &nbsp;(password can be anything)<br><br>
        <strong>What happens:</strong><br>
        The query becomes:<br>
        <code>SELECT * FROM users WHERE username=\'admin\' -- \' AND password=\'...\'</code><br>
        The <code>--</code> comments out the password check, granting access as admin.',
    'login_btn'          => 'Log In',
    'login_success'      => 'Login Successful',
    'login_failed'       => 'Login Failed &mdash; 0 rows returned',

    // ---- Login Secure ----
    'secure_login_title' => 'Secure Login',
    'secure_login_page'  => 'Secure Login - SQL Injection Lab',
    'secure_login_howto' => '<strong>How prepared statements prevent SQL injection:</strong><br><br>
        1. The SQL query template is sent to MySQL with <code>?</code> placeholders.<br>
        2. MySQL compiles the query <em>before</em> seeing any user data.<br>
        3. User values are sent separately and treated as <strong>literal data</strong>, never as SQL code.<br><br>
        <strong>Try the same payloads from the vulnerable page:</strong><br>
        <code>admin\' -- </code> &rarr; will fail (treated as a literal username string).<br>
        <code>\' OR \'1\'=\'1</code> &rarr; will fail (no matching user with that exact name).',
    'vuln_code_title'    => 'Vulnerable (string concat)',
    'safe_code_title'    => 'Secure (prepared statement)',
    'login_secure_btn'   => 'Log In (Secure)',
    'prepared_sql'       => 'Prepared SQL:',
    'bound_params'       => 'Bound params:',
    'login_legit'        => 'Login Successful &mdash; Legitimate credentials',
    'login_blocked'      => 'Login Failed &mdash; Injection attempt blocked',
    'payload_literal'    => 'The payload was treated as a literal string value.',
    'no_user_named'      => 'No user named',
    'exists_in_db'       => 'exists in the database.',

    // ---- Read Vulnerable ----
    'data_extract_title' => 'Data Extraction',
    'data_extract_page'  => 'Data Extraction - SQL Injection Lab',
    'lab_a'              => '<strong>Lab A &mdash; Dump all rows (OR 1=1):</strong><br>Enter the following to retrieve every user:',
    'lab_b'              => '<strong>Lab B &mdash; UNION injection (extract specific data):</strong><br>Use UNION SELECT to control which columns appear:',
    'lab_c'              => '<strong>Lab C &mdash; Explore the database schema:</strong><br>Extract table and column names from MySQL metadata:',
    'search_by_username' => 'Search by Username',
    'search_btn'         => 'Search',

    // ---- Update Vulnerable ----
    'update_title'       => 'Privilege Escalation (UPDATE Injection)',
    'update_page'        => 'Update Injection - SQL Injection Lab',
    'update_scenario'    => '<strong>Scenario:</strong> A "Change Password" form. The UPDATE query concatenates user input.',
    'update_step1'       => '<strong>Step 1:</strong> Type <strong>user1</strong> in the Username field.',
    'update_step2'       => '<strong>Step 2:</strong> Paste this into "New Password":',
    'update_result'      => '<strong>What happens:</strong><br>The query becomes:<br>',
    'update_escalation'  => 'user1\'s role changes from "user" to "admin" &mdash; privilege escalation.',
    'username_target'    => 'Username (target)',
    'new_password'       => 'New Password',
    'update_password_btn'=> 'Update Password',
    'current_users'      => 'Current Users Table',
    'db_reset_msg'       => 'Database has been reset to its original state.',
    'update_success'     => 'Update executed successfully.',
    'rows_affected'      => 'row(s) affected.',

    // ---- Delete Vulnerable ----
    'delete_title'       => 'Delete Injection',
    'delete_page'        => 'Delete Injection - SQL Injection Lab',
    'delete_scenario'    => '<strong>Scenario:</strong> A "Delete Account" form. The DELETE query concatenates user input.',
    'delete_normal'      => '<strong>Normal use:</strong> Enter a username like <code>user2</code> to delete one account.',
    'delete_malicious'   => '<strong>Malicious payload:</strong>',
    'delete_result'      => '<strong>What happens:</strong><br>The query becomes:<br>',
    'delete_all_rows'    => 'Since <code>\'1\'=\'1\'</code> is always true, <strong>all rows are deleted</strong>.',
    'delete_restore'     => 'Use the <strong>Reset Database</strong> button to restore the data after testing.',
    'username_to_delete' => 'Username to Delete',
    'delete_user_btn'    => 'Delete User',
    'delete_executed'    => 'DELETE executed.',
    'table_empty'        => 'Table is empty! All rows were deleted. Click "Reset Database" to restore.',

    // ---- Blind Vulnerable ----
    'blind_title'        => 'Blind SQL Injection',
    'blind_page'         => 'Blind SQL Injection - SQL Injection Lab',
    'db_users_count'     => 'Database: %d user(s) in table',
    'db_table_empty'     => 'Database: Table is EMPTY - click "Reset Database" below',
    'blind_what'         => '<strong>What makes it "blind"?</strong><br>
        This page only responds with <strong>TRUE</strong> (user exists) or <strong>FALSE</strong> (user not found).
        No table data is ever displayed. But an attacker can still extract data one character at a time.',
    'blind_technique'    => '<strong>Technique: Boolean-based extraction using SUBSTRING()</strong>',
    'blind_step1'        => 'Confirm the user exists:',
    'blind_step1_result' => '&rarr; should return TRUE',
    'blind_step2'        => 'Guess first character of password:',
    'blind_step2_result' => "&rarr; TRUE (it's 'a'!)",
    'blind_step3'        => 'Guess second character:',
    'blind_step3_result' => "&rarr; TRUE (it's 'd'!)",
    'blind_step4'        => 'Continue until the full password is reconstructed.',
    'check_user_exists'  => 'Check if User Exists',
    'check_btn'          => 'Check',
    'true_user_exists'   => 'TRUE &mdash; User exists',
    'true_condition'     => 'The condition evaluated to true (rows returned)',
    'false_user_not_found'=> 'FALSE &mdash; User not found',
    'false_condition'    => 'The condition evaluated to false (no rows returned)',
    'error_sql_syntax'   => 'ERROR &mdash; SQL syntax error',
    'cheat_title'        => 'Quick Reference: Extracting admin\'s password character by character',
    'cheat_desc'         => 'The admin password is <strong>admin123</strong>. Try these payloads:',
    'payload'            => 'Payload',
    'expected'           => 'Expected',

    // ---- Index Page - New Cards ----
    'card7_title'        => '7. Time-Based Blind SQLi',
    'card7_desc'         => 'Extract data by measuring server response time using SLEEP() and IF() conditions.',
    'card8_title'        => '8. Error-Based SQLi',
    'card8_desc'         => 'Force MySQL to reveal data inside error messages using EXTRACTVALUE() and UPDATEXML().',
    'card9_title'        => '9. Cheat Sheet',
    'card9_desc'         => 'Complete SQL injection reference: payloads, techniques, MySQL functions, and prevention methods.',
    'card10_title'       => '10. Quiz',
    'card10_desc'        => 'Test your SQL injection knowledge with 10 multiple-choice questions. Get instant feedback.',
    'reference'          => 'Reference',
    'assessment'         => 'Assessment',

    // ---- Progress Tracker ----
    'progress_title'     => 'Your Progress',
    'labs_visited'       => 'Labs visited',
    'quiz_score_label'   => 'Quiz Score',
    'not_taken'          => 'Not taken yet',
    'reset_progress'     => 'Reset Progress',

    // ---- Time-Based Blind SQLi ----
    'timebased_title'    => 'Time-Based Blind SQL Injection',
    'timebased_page'     => 'Time-Based Blind SQLi - SQL Injection Lab',
    'timebased_what'     => '<strong>What is time-based blind injection?</strong><br>
        When the application shows <strong>no visible difference</strong> between true and false conditions,
        an attacker can use <strong>SLEEP()</strong> to cause a deliberate delay. If the page takes longer
        to respond, the condition was TRUE.',
    'timebased_technique'=> '<strong>Technique: Time-based extraction using IF() + SLEEP()</strong>',
    'timebased_step1'    => 'Confirm SLEEP works:',
    'timebased_step1_result' => '&rarr; response should be delayed ~2 seconds',
    'timebased_step2'    => 'Guess first character of password:',
    'timebased_step2_result' => '&rarr; delayed ~2s (it\'s \'a\'!)',
    'timebased_step3'    => 'Guess second character:',
    'timebased_step3_result' => '&rarr; delayed ~2s (it\'s \'d\'!)',
    'timebased_step4'    => 'Continue until the full password is reconstructed by timing each request.',
    'timebased_input_label' => 'Enter Payload',
    'timebased_send_btn' => 'Send Query',
    'timebased_delayed'  => 'DELAYED &mdash; Condition was TRUE',
    'timebased_delayed_detail' => 'Response took %ss &mdash; the SLEEP() was triggered, meaning the condition evaluated to TRUE.',
    'timebased_instant'  => 'INSTANT &mdash; Condition was FALSE',
    'timebased_instant_detail' => 'Response took %ss &mdash; no delay detected, meaning the condition was FALSE.',
    'timebased_cheat_title' => 'Quick Reference: Time-Based Payloads',
    'timebased_cheat_desc'  => 'The admin password is <strong>admin123</strong>. A delay means the condition is TRUE:',
    'timebased_delay_word'  => 'delay',
    'timebased_instant_word'=> 'instant',

    // ---- Error-Based SQLi ----
    'errorbased_title'   => 'Error-Based SQL Injection',
    'errorbased_page'    => 'Error-Based SQLi - SQL Injection Lab',
    'errorbased_what'    => '<strong>What is error-based injection?</strong><br>
        When the application displays <strong>database error messages</strong>, an attacker can force
        MySQL to include sensitive data inside the error output using XML functions.',
    'errorbased_technique'=> '<br><strong>Useful functions:</strong><br>',
    'errorbased_extractvalue' => 'Using EXTRACTVALUE():',
    'errorbased_updatexml'   => 'Using UPDATEXML():',
    'errorbased_db_version'  => 'Get database version:',
    'errorbased_error_title' => 'MySQL Error Output (contains extracted data!)',
    'errorbased_data_in_error'=> 'Look for the highlighted text after the ~ character &mdash; that\'s the extracted data!',
    'errorbased_ref_title'   => 'Error-Based Payloads Reference',
    'errorbased_goal'        => 'Goal',
    'errorbased_goal_password'=> 'Extract admin password',
    'errorbased_goal_version' => 'Get MySQL version',
    'errorbased_goal_tables'  => 'List all tables',
    'errorbased_goal_columns' => 'List columns of users table',

    // ---- Cheat Sheet Page ----
    'cheatsheet_title'   => 'SQL Injection Cheat Sheet',
    'cheatsheet_page'    => 'Cheat Sheet - SQL Injection Lab',
    'cheatsheet_tag'     => 'Reference',
    'cs_auth_bypass'     => 'Authentication Bypass',
    'cs_auth_bypass_desc'=> 'Payloads to bypass login forms that use string concatenation:',
    'cs_description'     => 'Description',
    'cs_auth_1'          => 'Comment out password check (MySQL --)',
    'cs_auth_2'          => 'Comment out password check (MySQL #)',
    'cs_auth_3'          => 'Always-true condition with string comparison',
    'cs_auth_4'          => 'Always-true condition with integer comparison',
    'cs_auth_5'          => 'Comment using block syntax',
    'cs_auth_6'          => 'Empty string equals empty string',
    'cs_union'           => 'UNION-Based Injection',
    'cs_union_desc'      => 'UNION SELECT appends a second query to the original. The number of columns must match.',
    'cs_union_step1'     => 'Step 1: Find the number of columns',
    'cs_union_step2'     => 'Step 2: Find which columns are displayed',
    'cs_union_step3'     => 'Step 3: Extract data',
    'cs_union_error_at'  => 'error at',
    'cs_union_columns'   => 'columns',
    'cs_error'           => 'Error-Based Injection',
    'cs_error_desc'      => 'Force MySQL to reveal data inside error messages:',
    'cs_function'        => 'Function',
    'cs_blind'           => 'Blind SQL Injection',
    'cs_blind_desc'      => 'Extract data when no output or errors are visible:',
    'cs_blind_boolean'   => 'Boolean-Based',
    'cs_blind_time'      => 'Time-Based',
    'cs_exfil'           => 'Data Exfiltration',
    'cs_goal'            => 'Goal',
    'cs_exfil_version'   => 'MySQL version',
    'cs_exfil_db'        => 'Current database name',
    'cs_exfil_user'      => 'Current MySQL user',
    'cs_exfil_tables'    => 'All table names',
    'cs_exfil_columns'   => 'Column names of a table',
    'cs_exfil_all_data'  => 'All usernames & passwords',
    'cs_functions'       => 'MySQL Useful Functions',
    'cs_fn_version'      => 'MySQL server version',
    'cs_fn_database'     => 'Current database name',
    'cs_fn_user'         => 'Current MySQL user',
    'cs_fn_datadir'      => 'Data directory path',
    'cs_fn_concat'       => 'Concatenate strings together',
    'cs_fn_groupconcat'  => 'Concatenate values from multiple rows',
    'cs_fn_substring'    => 'Extract part of a string',
    'cs_fn_ascii'        => 'ASCII value of a character',
    'cs_fn_length'       => 'Length of a string',
    'cs_fn_sleep'        => 'Pause execution for n seconds',
    'cs_fn_if'           => 'Conditional: if cond then t else f',
    'cs_comments'        => 'SQL Comment Styles',
    'cs_syntax'          => 'Syntax',
    'cs_comment_dash'    => 'Single-line comment (needs trailing space)',
    'cs_comment_hash'    => 'Single-line comment (MySQL specific)',
    'cs_comment_block'   => 'Block / multi-line comment',
    'cs_comment_version' => 'MySQL version-conditional execution',
    'cs_prevention'      => 'Prevention & Mitigation',
    'cs_prevention_desc' => 'Best practices to prevent SQL injection in your applications:',
    'cs_prev_prepared'   => 'Prepared Statements',
    'cs_prev_prepared_desc' => 'Use parameterized queries (PDO, MySQLi) to separate SQL code from data.',
    'cs_prev_validate'   => 'Input Validation',
    'cs_prev_validate_desc' => 'Whitelist expected input formats. Reject unexpected characters.',
    'cs_prev_escape'     => 'Output Escaping',
    'cs_prev_escape_desc'=> 'Use htmlspecialchars() and proper encoding when displaying data.',
    'cs_prev_least'      => 'Least Privilege',
    'cs_prev_least_desc' => 'Database user should have minimum required permissions. Never use root.',
    'cs_prev_waf'        => 'Web Application Firewall',
    'cs_prev_waf_desc'   => 'Deploy a WAF to detect and block common injection patterns.',
    'cs_prev_errors'     => 'Hide Error Messages',
    'cs_prev_errors_desc'=> 'Never display raw database errors to users in production.',

    // ---- Quiz Page ----
    'quiz_title'         => 'SQL Injection Quiz',
    'quiz_page'          => 'Quiz - SQL Injection Lab',
    'quiz_tag'           => 'Assessment',
    'quiz_question'      => 'Question',
    'quiz_submit'        => 'Submit Answers',
    'quiz_retry'         => 'Try Again',
    'quiz_grade_excellent'=> 'Excellent! You master SQL injection concepts.',
    'quiz_grade_good'    => 'Good job! Review the topics you missed.',
    'quiz_grade_poor'    => 'Keep studying! Review the labs and cheat sheet.',

    'quiz_q1'            => 'What is SQL injection?',
    'quiz_q1_a'          => 'A method to encrypt database connections',
    'quiz_q1_b'          => 'A technique to manipulate SQL queries through user input',
    'quiz_q1_c'          => 'A database backup procedure',
    'quiz_q1_d'          => 'A type of database index optimization',
    'quiz_q1_explain'    => 'SQL injection is a code injection technique that exploits vulnerabilities by inserting malicious SQL code through user input fields.',

    'quiz_q2'            => 'Which payload bypasses a login form using <code>WHERE username=\'$input\'</code>?',
    'quiz_q2_a'          => 'SELECT * FROM users',
    'quiz_q2_b'          => 'DROP TABLE users',
    'quiz_q2_c'          => 'admin\' --',
    'quiz_q2_d'          => 'admin AND 1=1',
    'quiz_q2_explain'    => 'The payload <code>admin\' --</code> closes the string with a quote and comments out the rest of the query (password check) with --.',

    'quiz_q3'            => 'What does the <code>--</code> symbol do in MySQL?',
    'quiz_q3_a'          => 'It starts a single-line comment, ignoring the rest of the query',
    'quiz_q3_b'          => 'It negates a condition',
    'quiz_q3_c'          => 'It subtracts two values',
    'quiz_q3_d'          => 'It concatenates two strings',
    'quiz_q3_explain'    => '<code>--</code> (followed by a space) is a single-line comment in MySQL. Everything after it on the same line is ignored by the SQL parser.',

    'quiz_q4'            => 'What is the primary defense against SQL injection?',
    'quiz_q4_a'          => 'Input length validation',
    'quiz_q4_b'          => 'Prepared statements with bound parameters',
    'quiz_q4_c'          => 'Encrypting the database',
    'quiz_q4_d'          => 'Using HTTPS',
    'quiz_q4_explain'    => 'Prepared statements separate SQL code from data. The query structure is compiled first, then parameters are passed as data, making injection impossible.',

    'quiz_q5'            => 'What does <code>UNION SELECT</code> allow an attacker to do?',
    'quiz_q5_a'          => 'Delete database tables',
    'quiz_q5_b'          => 'Encrypt database values',
    'quiz_q5_c'          => 'Append additional query results to the original query',
    'quiz_q5_d'          => 'Create new database users',
    'quiz_q5_explain'    => 'UNION SELECT appends the results of a second query to the original result set, allowing an attacker to extract data from other tables or columns.',

    'quiz_q6'            => 'In blind SQL injection, how does an attacker extract data?',
    'quiz_q6_a'          => 'By observing true/false responses or time delays',
    'quiz_q6_b'          => 'By reading the HTML source code',
    'quiz_q6_c'          => 'By accessing the server filesystem',
    'quiz_q6_d'          => 'By decrypting the database password',
    'quiz_q6_explain'    => 'In blind SQLi, the attacker asks yes/no questions (boolean-based) or measures response time (time-based) to extract data one bit at a time.',

    'quiz_q7'            => 'What does <code>SLEEP(5)</code> do in a time-based blind injection?',
    'quiz_q7_a'          => 'Locks the database for 5 seconds',
    'quiz_q7_b'          => 'Pauses the query execution for 5 seconds if the condition is true',
    'quiz_q7_c'          => 'Deletes records after 5 seconds',
    'quiz_q7_d'          => 'Encrypts data for 5 rounds',
    'quiz_q7_explain'    => 'SLEEP(5) pauses MySQL execution for 5 seconds. Combined with IF(), it creates a measurable delay that leaks information about the condition.',

    'quiz_q8'            => 'Which of these is <strong>NOT</strong> a valid SQL injection prevention method?',
    'quiz_q8_a'          => 'Using prepared statements',
    'quiz_q8_b'          => 'Input validation and whitelisting',
    'quiz_q8_c'          => 'Least privilege database accounts',
    'quiz_q8_d'          => 'Hiding the login form behind JavaScript',
    'quiz_q8_explain'    => 'Hiding a form with JavaScript provides no security since requests can be sent directly (e.g., via curl). Real defenses operate at the server/database level.',

    'quiz_q9'            => 'What does <code>EXTRACTVALUE(1, CONCAT(0x7e, version()))</code> exploit?',
    'quiz_q9_a'          => 'MySQL error messages to reveal data in the error output',
    'quiz_q9_b'          => 'File read permissions on the server',
    'quiz_q9_c'          => 'The CONCAT function buffer overflow',
    'quiz_q9_d'          => 'XML parsing of user uploaded files',
    'quiz_q9_explain'    => 'EXTRACTVALUE forces an XPATH error. MySQL includes the evaluated expression (version()) in the error message, leaking data to the attacker.',

    'quiz_q10'           => 'What is the purpose of <code>information_schema</code> in SQL injection?',
    'quiz_q10_a'         => 'It stores user passwords',
    'quiz_q10_b'         => 'It logs all SQL queries',
    'quiz_q10_c'         => 'It contains metadata about all databases, tables, and columns',
    'quiz_q10_d'         => 'It provides encryption keys',
    'quiz_q10_explain'   => 'information_schema is a MySQL system database containing metadata about every database, table, column, and constraint. Attackers use it to discover the database structure.',
];
